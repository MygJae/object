# 간략한 내용 정리

# 5 책임 할당하기
- 어떤 객체에게 어떤 책임을 할당하는 것은 쉽지 않으며 책임 할당 과정은 일종의 트레이드오프 활동임
- 올바른 책임을 할당하기 위해서는 다양한 관점에서 설계를 평가할 수 있어야함

## 5-1 책임 주도 설계를 향해
### 데이터보다 행동을 먼저 결정하라
- 객체에게 중요한 것은 데이터가 아니라 외부에 제공하는 행동임
- 적절한 객체에게 적절한 책임을 할당하는 것이 중요하며 협력을 통해 책임을 할당해야 함

### 협력이라는 문맥 안에서 책임을 결정하라
- 책임은 객체의 입장이 아니라 객체가 참여하는 협력에 적합해야 함
- 적합한 책임은 메시지 수신자가 아니라 메시지 전송자에게 적합한 책임을 의미함 -> 메시지를 전송하는 클라이언트 의도에 적합한 책임을 할당해야 함
- 메시지를 결정한 후에 객체를 선택 -> 객체의 상태를 고민

### 책임 주도 설계
- 시스템이 사용자에게 제공해야하는 기능인 시스템 책임을 파악
- 시스템 책임을 더 작은 책임으로 분할함
- 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당함
- 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾음
- 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 함

## 5-2 책임 할당을 위한 GRASP 패턴
- General Responsibility Assignment Software Pattern(일반적인 책임 할당을 위한 소프트웨어 패턴)
- 객체에게 책임을 할당할 때 지침으로 삼을 수 이는 원칙들의 집합을 패턴 형식으로 정리한 것

### 도메인 개념에서 출발하기
- 책임을 할당해야 할 때 가장 먼저 고민해야 하는 유력한 후보는 도매인 개념임
- 도메인 개념을 정리하는데 너무 많은 시간을 들이지 말고 빠르게 설계와 구현을 진행해라
- 올바른 도메인 모델이란 존재하지 않음 -> 도메인 그대로를 투영한 모델이 아니라 구현에 도움이 되는 모델이 중요함 -> 실용적이면서 유용한 모델이 중요함

### 정보 전문가에게 책임을 할당하라
- 메시지를 전송할 객체는 무엇을 원하는가?
- 메시지를 수신할 적합한 객체는 누구인가?
- 위의 질문에 답하기 위해 객체가 상태와 행동을 통합한 캡슐화의 단위라는 사실에 집중해야 함
- INFORMATION EXPERT 패턴 = 책임을 정보전문가(책임을 수행하는데 필요한 정보를 가지고 있는 객체)에게 할당하라
- 정보 전문가가 데이터를 반드시 저장하고 있을 필요는 없다는 사실을 이해하는 것이 중요함
- 객체에게 책임을 할당할 때 가장 기본이되는 책임 할당 원칙
- 객체란 상태와 행동을 함께 가지는 단위라는 객체지향의 가장 기본적인 원리를 책임 할당의 관점에서 표현함

### 높은 응집도와 낮은 결합도
- LOW COUPLING(낮은 결합도) 패턴 = 의존성을 낮추고 변화의 영향을 줄이며 재사용성을 증가시킴
- HIGH COHESION(높은 응집도) 패턴 = 복잡성을 관리할 수 있는 수준으로 유지할 것인지

### 창조자에게 객체 생성 책임을 할당하라
- CREATOR(창조자) 패턴 = 객체를 생성할 책임을 어떤 객체에게 할당할지에 대한 지침
    - A 객체의 생성 책임을 가지는 객체 조건
    - A 객체를 포함하거나 참조함
    - A 객체를 기록함
    - A 객체를 긴밀하게 사용함
    - A 객체를 초기화하는 데 필요한 데이터를 가지고 있음

## 5-3 구현을 통한 검증
### DiscountCondition 개선하기
- 변경에 취약한 클래스
- (1)새로운 할인 조건 추가
- (2)순번 조건을 판단하는 로직 변경
- (3)기존 조건을 판단하는 로직이 변경되는 경우
- DiscountCondition은 위 세가지 이유로 응집도가 낮으며 이를 해결하기위에서는 변경의 이유에 따라 클래스를 분리해야 함
- 함께 초기화되는 속성을 기준으로 코드를 분리해야 함
- 메서드들이 인스턴스 변수를 사용하는 방식을 확인함
- 속성 그룹과 해당 그룹에 접근하는 메서드 그룹을 기준으로 코드를 분리해야 함

### 타입 분리하기
- PeriodCondition과 SequenceCondition으로 분리함
- Movie 객체 내부에 두개의 조건을 가지고 있으므로 결합도가 더 높아짐

### 다형성을 통해 분리하기
- PeriodCondition과 SequenceCondition 두 컨디션은 같은 책임을 가지고 있으므로 역할(DiscountCondition)이 등장함
- POLYMORPHISM(다형성) 패턴 = 객체의 타입에 따라 변하는 행동이 있따면 타입을 분리하고 변화하는 행동을 각 타입의 책임으로 할당해야 함
- 책임을 분산시킴

### 변경으로부터 보호하기
- PROTECTED VARIATIONS(변경 보호) 패턴 = 변경을 캡슐화하도로 책임을 할당하는 것
- Movie 입장에서는 새로운 컨디션이 추가되어도 DiscountCondition만 알고 있으면 됨
- 안정적인 인터페이스 뒤로 변경을 캡슐화함

### Movie 클래스 개선하기
- 데이터 중심의 설계는 데이터와 관련된 클래스의 내부 구현이 인터페이스에 여과 없이 노출되기 때문에 캡슐화를 지키기 어려움 -> 응집도가 낮고 결합도가 높은 변경에 취약한 코드가 만들어질 가능성이 높음
- 데이터가 아닌 책임을 중심으로 설계해라
- 변경 역시 도메인 모델의 일부임

### 변경과 유연성
- 설계를 주도하는 것은 변경임
- 코드를 이해하고 수정하기 쉽게 최대한 단순하게 설계하는 것
- 코드를 수정하지 않고도 변경을 수요할 수 있도록 코드를 더 유연하게 만드는 것
- 상속으로 구현된 Movie 클래스는 할인 정책이 추가될수록 새로운 인스턴스를 생성하고 상태를 복사하고 식별자를 관리하는 코드를 계속해서 추가헤야 함
- 상속대신 합성을 사용하여 유연한 설계 구조를 만듬

## 5-4 책임 주도 설계의 대안
- 책임주도 설계에 익숙해지는 것은 부단한 노력과 시간이 필요하므로 최대한 빠르게 목적한 기능을 수행하는 코드를 작성한 후 리팩터링을 통해 소프트웨어를 개선하는 것도 하나의 좋은 방법임

### 메서드 응집도
- 긴 메서드 코드의 문제점
    - 어떤 일을 수행하는지 하눈에 파악하기 어려워 코드를 전체적으로 이해하는데 많은 시간이 걸림
    - 하나의 메서드 안에 너무 많은 작업을 처리하기 때문에 변경이 필요할 떄 수정해야 할 부분을 찾기 어려움
    - 메서드 내부의 일부 로직만 수정하더라도 메서드의 나머지 부분에서 버그가 발생할 확률이 높음
    - 로직의 일부만 재사용하는 것이 불가능함
    - 코드를 재사용하는 유일한 방법은 원하는 코드를 복사해서 붙여넣는 것뿐이므로 코드 중복을 초래하기 쉬움
- 이러한 메서드를 몬스터 메서드(monster method)라고 부름

### 객체를 자율적으로 만들자
- 메서드가 사용하는 데이터를 저장하고 있는 클래스로 메서드를 이동시키면 됨
- 메서드를 이동할 때 캡슐화, 응집도, 결합도의 측면에서 이동시킨 메서드의 적절성을 판단하면 됨
- 책임 주도 설계에 익숙하지 않을 시 데이터 중심으로 구현한 후 이를 래팩터링하더라도 유사한 결과를 얻을 수 있음

# 읽고 느낀 점
- 객체지향적인 개발을 하려고 생각할 떄마다 처음이 너무 어렵게 느껴졌다.
- 어떻게 협력을 구축하고 책임을 할당하며 내가 처음부터 이런 설계를 잘 할 수 있을지에 대해 막막하게 느껴졌던 것 같다.
- 책에서 제시해주는 방향 중 하나인 먼저 구현하고 리팩터링을 통해 책임 주도 설계와 비슷한 효과를 가질 수 있다고 한다.
- 처음부터 완벽하게 해내려고 하기보다는 내가 먼저 할 수 있는 일을 해야겠다라는 생각이 들었다.